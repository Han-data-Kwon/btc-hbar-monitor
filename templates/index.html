<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ“ˆ ì‹¤ì‹œê°„ ê³ ë˜ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial; background: #fff; color: #000; margin: 20px; }
    .tab { display: none; }
    .tab.active { display: block; }
    button { margin: 5px 5px 15px 0; padding: 8px 16px; font-weight: bold; }
    .card { border: 1px solid #ccc; border-radius: 6px; padding: 10px; margin-bottom: 12px; background: #f7f7f7; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; font-size: 14px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #eee; }
    .buy { color: red; font-weight: bold; }
    .sell { color: blue; font-weight: bold; }
  </style>
</head>
<body>

<h1>ğŸ‹ ê³ ë˜ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</h1>

<!-- íƒ­ ë²„íŠ¼ -->
<div>
  <button onclick="showTab('price')">ğŸ’° ì‹œì„¸</button>
  <button onclick="showTab('news')">ğŸ“° ë‰´ìŠ¤</button>
  <button onclick="showTab('economic')">ğŸ“… ê²½ì œì§€í‘œ</button>
  <button onclick="showTab('whale')">ğŸ³ ê³ ë˜ ê±°ë˜</button>
</div>

<!-- ì‹œì„¸ íƒ­ -->
<div id="price" class="tab active">
  <h2>ğŸ’° ì‹¤ì‹œê°„ ì‹œì„¸</h2>
  <div id="priceCards"></div>
</div>

<!-- ë‰´ìŠ¤ íƒ­ -->
<div id="news" class="tab">
  <h2>ğŸ“° ì½”ì¸ ë‰´ìŠ¤ ìš”ì•½</h2>
  <div id="newsList"></div>
</div>

<!-- ê²½ì œì§€í‘œ íƒ­ -->
<div id="economic" class="tab">
  <h2>ğŸ“… ì£¼ìš” ê²½ì œì§€í‘œ</h2>
  <table>
    <thead><tr><th>ë‚ ì§œ</th><th>ì§€í‘œëª…</th><th>êµ­ê°€</th><th>í•´ì„</th></tr></thead>
    <tbody id="economicTable"></tbody>
  </table>
</div>

<!-- ê³ ë˜ ë¶„ì„ íƒ­ -->
<div id="whale" class="tab">
  <h2>ğŸ³ BTC ê³ ë˜ ê±°ë˜</h2>
  <table>
    <thead><tr><th>ì‹œê°„</th><th>From</th><th>To</th><th>ìˆ˜ëŸ‰</th><th>êµ¬ê°„</th><th>ë§¤ìˆ˜/ë§¤ë„</th></tr></thead>
    <tbody id="btcTable"></tbody>
  </table>
  <h2>ğŸ§Š HBAR ê³ ë˜ ê±°ë˜</h2>
  <table>
    <thead><tr><th>ì‹œê°„</th><th>From</th><th>To</th><th>ìˆ˜ëŸ‰</th><th>êµ¬ê°„</th><th>ë§¤ìˆ˜/ë§¤ë„</th></tr></thead>
    <tbody id="hbarTable"></tbody>
  </table>
</div>

<script>
function showTab(tabId) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');
}

async function loadPrices() {
  const res = await fetch("/api/price");
  const data = await res.json();
  const wrap = document.getElementById("priceCards");
  wrap.innerHTML = Object.entries(data).map(([key, d]) => `
    <div class="card">
      <h3>${key}</h3>
      <p>ê°€ê²©: $${d.price.toLocaleString()}</p>
      <p>24ì‹œê°„ ë³€ë™ë¥ : ${d.change >= 0 ? '+' : ''}${d.change}%</p>
    </div>
  `).join('');
}

async function loadNews() {
  const res = await fetch("/api/news");
  const news = await res.json();
  document.getElementById("newsList").innerHTML = news.map(n => `
    <div class="card">
      <a href="${n.link}" target="_blank"><strong>${n.title}</strong></a><br>
      <small>ğŸ•’ ${n.published}</small>
    </div>
  `).join('');
}

async function loadEconomic() {
  const res = await fetch("/api/economics");
  const data = await res.json();
  document.getElementById("economicTable").innerHTML = data.map(e => `
    <tr><td>${e.date}</td><td>${e.event}</td><td>${e.country}</td><td>${e.impact}</td></tr>
  `).join('');
}

async function loadWhales() {
  const btc = await fetch("/api/btc_trades").then(r => r.json());
  const hbar = await fetch("/api/hbar_trades").then(r => r.json());

  document.getElementById("btcTable").innerHTML = btc.map(t => `
    <tr>
      <td>${t.time}</td><td>${t.from}</td><td>${t.to}</td><td>${t.amount}</td><td>${t.type}</td>
      <td class="${t.direction === 'ë§¤ìˆ˜' ? 'buy' : 'sell'}">${t.direction}</td>
    </tr>
  `).join('');

  document.getElementById("hbarTable").innerHTML = hbar.map(t => `
    <tr>
      <td>${t.time}</td><td>${t.from}</td><td>${t.to}</td><td>${t.amount}</td><td>${t.type}</td>
      <td class="${t.direction === 'ë§¤ìˆ˜' ? 'buy' : 'sell'}">${t.direction}</td>
    </tr>
  `).join('');
}

function loadAll() {
  loadPrices();
  loadNews();
  loadEconomic();
  loadWhales();
}

loadAll();
setInterval(loadAll, 30000);
</script>

</body>
</html>