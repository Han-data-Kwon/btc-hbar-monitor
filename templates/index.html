<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ“ˆ ì‹¤ì‹œê°„ ê³ ë˜ ì¶”ì  ëŒ€ì‹œë³´ë“œ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: 'Arial'; padding: 20px; background: #fff; color: #000; transition: 0.3s; }
    .dark-mode { background: #121212; color: #eee; }
    .tab { display: none; }
    .tab.active { display: block; }
    .tabs button { margin-right: 10px; padding: 8px 16px; font-weight: bold; }
    .card { border: 1px solid #ccc; border-radius: 6px; padding: 12px; margin-bottom: 10px; background: #f8f8f8; }
    .dark-mode .card { background: #2e2e2e; border-color: #444; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
    th, td { border: 1px solid #aaa; padding: 6px; text-align: center; }
    th { background: #ddd; }
    .dark-mode th { background: #444; }
    .buy { color: red; font-weight: bold; }
    .sell { color: blue; font-weight: bold; }
  </style>
</head>
<body>

<h1>ğŸ‹ ì‹¤ì‹œê°„ ê³ ë˜ ì¶”ì  ëŒ€ì‹œë³´ë“œ</h1>
<button onclick="toggleDarkMode()">ğŸŒ™ ë‹¤í¬ëª¨ë“œ ì „í™˜</button>

<div class="tabs">
  <button onclick="showTab('indicators')">ğŸ“Š ì½”ì¸ ì§€í‘œ</button>
  <button onclick="showTab('news')">ğŸ“° ë‰´ìŠ¤ ìš”ì•½</button>
  <button onclick="showTab('economics')">ğŸ“… ê²½ì œì§€í‘œ</button>
  <button onclick="showTab('whale')">ğŸ³ ê³ ë˜ ê±°ë˜ ë¶„ì„</button>
</div>

<!-- ğŸ“Š ì½”ì¸ ì§€í‘œ -->
<div id="indicators" class="tab active">
  <h2>ğŸ“Š ì£¼ìš” ì½”ì¸ ì‹œì„¸</h2>
  <div id="priceCards" class="grid"></div>
</div>

<!-- ğŸ“° ë‰´ìŠ¤ ìš”ì•½ -->
<div id="news" class="tab">
  <h2>ğŸ“° ìµœì‹  ì½”ì¸ ë‰´ìŠ¤ ìš”ì•½</h2>
  <div id="newsList"></div>
</div>

<!-- ğŸ“… ê²½ì œì§€í‘œ -->
<div id="economics" class="tab">
  <h2>ğŸ“… ì£¼ìš” ê²½ì œì§€í‘œ ë° í•´ì„</h2>
  <table>
    <thead><tr><th>ì§€í‘œ</th><th>ë°œí‘œì¼</th><th>ì˜í–¥ë„</th><th>í•´ì„</th></tr></thead>
    <tbody id="econTable"></tbody>
  </table>
</div>

<!-- ğŸ³ ê³ ë˜ ë¶„ì„ -->
<div id="whale" class="tab">
  <h2>ğŸ³ BTC ê³ ë˜ ê±°ë˜</h2>
  <table>
    <thead><tr><th>ì‹œê°„</th><th>From</th><th>To</th><th>ìˆ˜ëŸ‰</th><th>êµ¬ê°„</th><th>ë§¤ìˆ˜/ë§¤ë„</th></tr></thead>
    <tbody id="btcTable"></tbody>
  </table>
  <h2>ğŸ§Š HBAR ê³ ë˜ ê±°ë˜</h2>
  <table>
    <thead><tr><th>ì‹œê°„</th><th>From</th><th>To</th><th>ìˆ˜ëŸ‰</th><th>êµ¬ê°„</th><th>ë§¤ìˆ˜/ë§¤ë„</th></tr></thead>
    <tbody id="hbarTable"></tbody>
  </table>
</div>

<script>
function showTab(id) {
  document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function toggleDarkMode() {
  document.body.classList.toggle('dark-mode');
}

async function loadPrices() {
  const res = await fetch("/api/price");
  const data = await res.json();
  const wrap = document.getElementById("priceCards");
  wrap.innerHTML = Object.entries(data).map(([key, d]) => `
    <div class="card">
      <h3>${key}</h3>
      <p>ê°€ê²©: $${d.price.toLocaleString()}</p>
      <p>ë³€ë™ë¥ : ${d.change >= 0 ? '+' : ''}${d.change}%</p>
    </div>
  `).join('');
}

async function loadNews() {
  const res = await fetch("/api/news");
  const data = await res.json();
  document.getElementById("newsList").innerHTML = data.map(n => `
    <div class="card">
      <a href="${n.link}" target="_blank"><strong>${n.title}</strong></a>
      <p>${n.summary}</p>
      <small>ë°œí–‰ì¼: ${n.published}</small>
    </div>
  `).join("");
}

async function loadEcon() {
  const res = await fetch("/api/economic");
  const data = await res.json();
  document.getElementById("econTable").innerHTML = data.map(e => `
    <tr><td>${e.event}</td><td>${e.date}</td><td>${e.impact}</td><td>${e.interpret}</td></tr>
  `).join('');
}

async function loadWhale() {
  const btc = await fetch("/api/btc_trades").then(r => r.json());
  const hbar = await fetch("/api/hbar_trades").then(r => r.json());

  document.getElementById("btcTable").innerHTML = btc.map(t => `
    <tr>
      <td>${t.time}</td><td>${t.from}</td><td>${t.to}</td><td>${t.amount}</td>
      <td>${t.type}</td><td class="${t.direction === 'ë§¤ìˆ˜' ? 'buy' : 'sell'}">${t.direction}</td>
    </tr>
  `).join('');

  document.getElementById("hbarTable").innerHTML = hbar.map(t => `
    <tr>
      <td>${t.time}</td><td>${t.from}</td><td>${t.to}</td><td>${t.amount}</td>
      <td>${t.type}</td><td class="${t.direction === 'ë§¤ìˆ˜' ? 'buy' : 'sell'}">${t.direction}</td>
    </tr>
  `).join('');
}

function loadAll() {
  loadPrices();
  loadNews();
  loadEcon();
  loadWhale();
}

loadAll();
setInterval(loadAll, 30000);
</script>

</body>
</html>